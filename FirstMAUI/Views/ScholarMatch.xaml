<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FirstMAUI.Views.ScholarMatch"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:components="clr-namespace:FirstMAUI.Components"
    xmlns:utils="clr-namespace:FirstMAUI.Utils">

    <ContentPage.Resources>
        <ResourceDictionary>
            <utils:BoolToVietnameseVerifiedConverter x:Key="BoolToVietnameseVerifiedConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView Grid.Row="0">
        <CollectionView
            Margin="20"
            ItemsSource="{Binding Scholarships}"
            SelectionMode="None">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border
                        Margin="0,10"
                        Padding="5"
                        BackgroundColor="White"
                        Stroke="#ccc"
                        StrokeShape="RoundRectangle 10">
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.NavigateToDetailCommand}" CommandParameter="{Binding .}" />
                        </Border.GestureRecognizers>


                        <VerticalStackLayout Padding="20" Spacing="10">

                            <Label
                                FontAttributes="Bold"
                                FontSize="18"
                                Text="{Binding Title}" />

                            <HorizontalStackLayout Spacing="5">
                                <!--  Verified  -->
                                <Border
                                    Padding="5,2"
                                    Stroke="Transparent"
                                    StrokeShape="RoundRectangle 5">
                                    <Border.Triggers>
                                        <DataTrigger
                                            Binding="{Binding IsVerified}"
                                            TargetType="Border"
                                            Value="True">
                                            <Setter Property="BackgroundColor" Value="LightGreen" />
                                        </DataTrigger>
                                        <DataTrigger
                                            Binding="{Binding IsVerified}"
                                            TargetType="Border"
                                            Value="False">
                                            <Setter Property="BackgroundColor" Value="LightCoral" />
                                        </DataTrigger>
                                    </Border.Triggers>
                                    <Label Text="{Binding IsVerified, Converter={StaticResource BoolToVietnameseVerifiedConverter}, ConverterParameter=IsVerified}" />
                                </Border>

                                <!--  Full Scholarship  -->
                                <Border
                                    Padding="5,2"
                                    Stroke="Transparent"
                                    StrokeShape="RoundRectangle 5">
                                    <Border.Triggers>
                                        <DataTrigger
                                            Binding="{Binding IsFullScholarship}"
                                            TargetType="Border"
                                            Value="True">
                                            <Setter Property="BackgroundColor" Value="LightGreen" />
                                        </DataTrigger>
                                        <DataTrigger
                                            Binding="{Binding IsFullScholarship}"
                                            TargetType="Border"
                                            Value="False">
                                            <Setter Property="BackgroundColor" Value="LightYellow" />
                                        </DataTrigger>
                                    </Border.Triggers>
                                    <Label Text="{Binding IsFullScholarship, Converter={StaticResource BoolToVietnameseVerifiedConverter}, ConverterParameter=IsFullScholarship}" />
                                </Border>

                                <!--  Deadline  -->
                                <Border
                                    Padding="5,2"
                                    Stroke="Transparent"
                                    StrokeShape="RoundRectangle 5">
                                    <Border.Triggers>
                                        <DataTrigger
                                            Binding="{Binding IsDeadlineSoon}"
                                            TargetType="Border"
                                            Value="True">
                                            <Setter Property="BackgroundColor" Value="LightCoral" />
                                        </DataTrigger>
                                        <DataTrigger
                                            Binding="{Binding IsDeadlineSoon}"
                                            TargetType="Border"
                                            Value="False">
                                            <Setter Property="BackgroundColor" Value="LightGreen" />
                                        </DataTrigger>
                                    </Border.Triggers>
                                    <Label Text="{Binding Deadline, StringFormat='â° {0}'}" />
                                </Border>
                            </HorizontalStackLayout>



                            <HorizontalStackLayout Spacing="5">
                                <Label Text="{Binding Country, StringFormat='ðŸŒ {0}'}" />
                                <Label Text="â€¢" />
                                <Label Text="{Binding Level, StringFormat='ðŸŽ“ {0}'}" />
                                <Label Text="â€¢" />
                                <Label Text="{Binding Field, StringFormat='ðŸ’¼ {0}'}" />
                            </HorizontalStackLayout>

                            <Label
                                FontSize="13"
                                Text="{Binding Description}"
                                TextColor="Gray" />
                        </VerticalStackLayout>

                        <!--  visual states  -->
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="Pressed">
                                    <VisualState.Setters>
                                        <Setter Property="Opacity" Value="0.7" />
                                        <Setter Property="Scale" Value="0.97" />
                                    </VisualState.Setters>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </ScrollView>
</ContentPage>
