<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FirstMAUI.Views.CommunityPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml">
    <ContentPage.Resources>
        <ResourceDictionary>
            <Style x:Key="PostCardStyle" TargetType="Frame">
                <Setter Property="CornerRadius" Value="10" />
                <Setter Property="BackgroundColor" Value="White" />
                <Setter Property="HasShadow" Value="True" />
                <Setter Property="Padding" Value="12" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!--  Use a Grid so we can overlay a floating action button (FAB)  -->
    <Grid>
        <ScrollView>
            <VerticalStackLayout Padding="16" Spacing="12">

                <SearchBar x:Name="SearchBarControl" Placeholder="Tìm kiếm thảo luận..." />

                <HorizontalStackLayout Spacing="8">
                    <Button
                        x:Name="BtnAll"
                        BackgroundColor="#1F3358"
                        Text="Tất cả"
                        TextColor="White" />
                    <Button
                        x:Name="BtnFulbright"
                        BackgroundColor="#EEF3F8"
                        Text="Fulbright"
                        TextColor="#1F3358" />
                    <Button
                        x:Name="BtnChevening"
                        BackgroundColor="#EEF3F8"
                        Text="Chevening"
                        TextColor="#1F3358" />
                    <Button
                        x:Name="BtnAustralia"
                        BackgroundColor="#EEF3F8"
                        Text="Australia Awards"
                        TextColor="#1F3358" />
                </HorizontalStackLayout>

                <Label
                    x:Name="CountLabel"
                    Text="156 thảo luận"
                    TextColor="#1F3358" />

                <CollectionView
                    x:Name="PostsCollectionView"
                    ItemsSource="{Binding Posts}"
                    SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Style="{StaticResource PostCardStyle}">
                                <VerticalStackLayout Spacing="8">
                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="15"
                                        Text="{Binding Scholarship.Title}"
                                        TextColor="#1F3358" />

                                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                                        <Frame
                                            Padding="8"
                                            BackgroundColor="#6B46C1"
                                            CornerRadius="20"
                                            HeightRequest="40"
                                            WidthRequest="40">
                                            <Label
                                                HorizontalOptions="Center"
                                                Text="{Binding AuthorInitials}"
                                                TextColor="White"
                                                VerticalOptions="Center" />
                                        </Frame>
                                        <VerticalStackLayout>
                                            <Label FontAttributes="Bold" Text="{Binding AuthorName}" />
                                            <Label
                                                FontSize="12"
                                                Text="{Binding TimeAgo}"
                                                TextColor="Gray" />
                                        </VerticalStackLayout>
                                    </HorizontalStackLayout>

                                    <Label
                                        FontAttributes="Bold"
                                        FontSize="16"
                                        Text="{Binding Title}" />
                                    <Label
                                        LineBreakMode="WordWrap"
                                        Text="{Binding Content}"
                                        TextColor="#333" />
                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>

        <!--  Floating action button: positioned bottom-right, with comfortable margin  -->
        <Button
            x:Name="FabAddComment"
            Margin="0,0,24,48"
            BackgroundColor="#6B46C1"
            Clicked="OnAddCommentClicked"
            CornerRadius="28"
            FontSize="24"
            HeightRequest="56"
            HorizontalOptions="End"
            Text="＋"
            TextColor="White"
            VerticalOptions="End"
            WidthRequest="56" />
    </Grid>
</ContentPage>
