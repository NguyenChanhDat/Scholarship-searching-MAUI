<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FirstMAUI.Views.SuggestionPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:components="clr-namespace:FirstMAUI.Components"
    xmlns:utils="clr-namespace:FirstMAUI.Utils">

    <ContentPage.Resources>
        <ResourceDictionary>
            <utils:BoolToVietnameseVerifiedConverter x:Key="BoolToVietnameseVerifiedConverter" />
            <utils:SuitableLevelToColorConverter x:Key="SuitableLevelToColorConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <ScrollView Grid.Row="0">
        <VerticalStackLayout>

            <!--  Header: profile analysis  -->
            <Border
                Margin="20,20,20,10"
                Padding="16"
                StrokeShape="RoundRectangle12">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Offset="0" Color="DarkBlue" />
                        <GradientStop Offset="1" Color="MidnightBlue" />
                    </LinearGradientBrush>
                </Border.Background>

                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout Spacing="8" VerticalOptions="Center">
                        <Label
                            FontSize="20"
                            Text="ðŸŽ¯"
                            TextColor="White" />
                        <Label
                            FontAttributes="Bold"
                            FontSize="18"
                            Text="PhÃ¢n tÃ­ch há»“ sÆ¡"
                            TextColor="White" />
                    </HorizontalStackLayout>

                    <Label
                        FontSize="14"
                        Text="Dá»±a trÃªn thÃ´ng tin cá»§a báº¡n, chÃºng tÃ´i tÃ¬m tháº¥y 12 há»c bá»•ng phÃ¹ há»£p"
                        TextColor="White" />

                    <ProgressBar
                        BackgroundColor="#E6E6E6"
                        HeightRequest="8"
                        Progress="0.85"
                        ProgressColor="#33C481" />

                    <Label
                        FontSize="12"
                        Text="Má»©c Ä‘á»™ phÃ¹ há»£p: 85%"
                        TextColor="White" />
                </VerticalStackLayout>
            </Border>

            <CollectionView
                Margin="20"
                ItemsSource="{Binding Scholarships}"
                SelectionMode="None">

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border
                            Margin="0,10"
                            Padding="5"
                            BackgroundColor="White"
                            Stroke="#ccc"
                            StrokeShape="RoundRectangle10">
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.NavigateToDetailCommand}" CommandParameter="{Binding .}" />
                            </Border.GestureRecognizers>


                            <VerticalStackLayout Padding="20" Spacing="10">

                                <Label
                                    FontAttributes="Bold"
                                    FontSize="18"
                                    Text="{Binding Title}" />

                                <HorizontalStackLayout Spacing="5">
                                    <!--  Verified  -->
                                    <Border
                                        Padding="5,2"
                                        Stroke="Transparent"
                                        StrokeShape="RoundRectangle 5">
                                        <Border.Triggers>
                                            <DataTrigger
                                                Binding="{Binding IsVerified}"
                                                TargetType="Border"
                                                Value="True">
                                                <Setter Property="BackgroundColor" Value="LightGreen" />
                                            </DataTrigger>
                                            <DataTrigger
                                                Binding="{Binding IsVerified}"
                                                TargetType="Border"
                                                Value="False">
                                                <Setter Property="BackgroundColor" Value="LightCoral" />
                                            </DataTrigger>
                                        </Border.Triggers>
                                        <Label Text="{Binding IsVerified, Converter={StaticResource BoolToVietnameseVerifiedConverter}, ConverterParameter=IsVerified}" />
                                    </Border>

                                    <!--  Full Scholarship  -->
                                    <Border
                                        Padding="5,2"
                                        Stroke="Transparent"
                                        StrokeShape="RoundRectangle 5">
                                        <Border.Triggers>
                                            <DataTrigger
                                                Binding="{Binding IsFullScholarship}"
                                                TargetType="Border"
                                                Value="True">
                                                <Setter Property="BackgroundColor" Value="LightGreen" />
                                            </DataTrigger>
                                            <DataTrigger
                                                Binding="{Binding IsFullScholarship}"
                                                TargetType="Border"
                                                Value="False">
                                                <Setter Property="BackgroundColor" Value="LightYellow" />
                                            </DataTrigger>
                                        </Border.Triggers>
                                        <Label Text="{Binding IsFullScholarship, Converter={StaticResource BoolToVietnameseVerifiedConverter}, ConverterParameter=IsFullScholarship}" />
                                    </Border>
                                </HorizontalStackLayout>

                                <Label
                                    FontAttributes="Bold"
                                    FontSize="13"
                                    Text="{Binding SuitableLevel, StringFormat='PhÃ¹ há»£p {0}%'}"
                                    TextColor="{Binding SuitableLevel, Converter={StaticResource SuitableLevelToColorConverter}}" />


                                <HorizontalStackLayout Spacing="5">
                                    <Label Text="{Binding Country, StringFormat='ðŸŒ {0}'}" />
                                    <Label Text="â€¢" />
                                    <Label Text="{Binding Level, StringFormat='ðŸŽ“ {0}'}" />
                                    <Label Text="â€¢" />
                                    <Label Text="{Binding Field, StringFormat='ðŸ’¼ {0}'}" />
                                </HorizontalStackLayout>

                                <Label
                                    FontSize="13"
                                    Text="{Binding Description}"
                                    TextColor="Gray" />
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
